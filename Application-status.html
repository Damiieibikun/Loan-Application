<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Application Status</title>
    <link rel="stylesheet" href="css/style.css" />
  </head>

  <body>
    <nav>
      <img src="images/logo2.png" alt="" id="logo-img" />
      <div id="notification">
        <p id="currentdate"></p>
        <img src="images/envelope.png" alt="" id="notification-icon" />
        <div id="notification-num" onclick="showMsg()">1</div>
        <div id="message">
          <span id="dot">. </span>New Message: Application Status
        </div>
      </div>
    </nav>
    <div id="app-letter">
      <h1>Application Status</h1>
      <div id="intro-letter"></div>
      <ul>
        <b id="criteria"></b></b>
      </ul>
      <div id="closing-letter"></div>
    </div>

    <script>
      //Navigation
      const today = new Date().toDateString();
      document.getElementById("currentdate").innerText = today;
      let count = 0;
      function showMsg() {
        count % 2 === 0
          ? (document.getElementById("message").style.display = "block")
          : (document.getElementById("message").style.display = "none");
        count++;
      }

      //Loan application
      //Retrieve data from local storage
      let applicantDetails = JSON.parse(
        localStorage.getItem("Loan-Application")
      );

      let introLetter_rej = `<h2>Update on your Loan application from Quantum Leap</h2>

<h3>Dear ${applicantDetails.FirstName},</h3>

<p>Thank you for your interest in a loan from Quantum Leap. We carefully reviewed your application for a loan in the amount of <b>$${applicantDetails.LoanRequested}</b>.

<br>
We are unable to approve your loan application at this time.

<br>
After a thorough review of your application, we were unable to meet your request based on the following criteria: </p>`;

      let closingLetter_rej = `
<br><br>
<p>We understand that this news may be disappointing. We encourage you to contact a loan officer at (+123)-456-789 or customercare@quantumleap.com to discuss your application further. 
    We may be able to offer suggestions for improving your creditworthiness.</p>
Sincerely,
<br><br>
<p>
Damilola Ibikunle
<br>
Senior Loan Officer
<br><br>
<i>Quantum Leap
<br>
123 Somewhere, Someplace.</i></p>`;

///////////////////////////////////////////////////////

let introLetter_aprov = `<h2>Loan Approval from Quantum Leap</h2>

<h3>Dear ${applicantDetails.FirstName},</h3>

<p>We are pleased to inform you that your application for the amount of <b>$${applicantDetails.LoanRequested}</b> has been approved!.
<br>
Your application met all of our requirements, and we believe this loan will be a valuable tool to help you achieve your financial goals.
<br><br>
Your Loan Details: </p>`;

let closingLetter_approv = `

<p>To finalize your loan, please:
<ul>
<li>Sign and return a copy of the enclosed loan agreement.</li>
<li>
    Provide any additional documentation that may be required (list any specific documents). 
    </li>
</ul>

Once we receive the signed agreement and any requested documents, we will process your loan and disburse the funds within 10 business days.</p>
<br>
<p>
    We are confident that you will make good use of this loan.  
    <br><br>Congratulations on your approval, and please do not hesitate to contact a loan officer at
    at (+123)-456-789 or email at customercare@quantumleap.com.</p>
    <br>
<p> 
Sincerely,
<br><br>
<p>
Damilola Ibikunle
<br>
Senior Loan Officer
<br><br>
<i>Quantum Leap
<br>
123 Somewhere, Someplace.</i>
</p>`;

///////////////////////////////////////////////////////

      if (applicantDetails.FinalPoints < 30) {
        console.log("yes it is");
        for (var i in applicantDetails) {
          if (
            i !== "FirstName" &&
            i !== "LastName" &&
            i !== "Email" &&
            i !== "DateRequested" &&
            i !== "DateRepayed" &&
            i !== "FinalPoints" &&
            i !== "LoanRequested"
          ) {
            var li = document.createElement("li");
            li.innerHTML = `${i}: ${applicantDetails[i]}`;
            document.getElementById("criteria").append(li);
          }
        }

        document.getElementById("intro-letter").innerHTML = introLetter_rej;
        document.getElementById("closing-letter").innerHTML = closingLetter_rej;
      } else {
        let li = document.createElement("li");
        li.innerText = `Request Date: ${applicantDetails.DateRequested}`;        
        let li2 = document.createElement("li");
        li2.innerText = `Repayment Date: ${applicantDetails.DateRepayed}`; 
        let li3 = document.createElement("li");
        li3.innerText = '2% per Month';
        document.getElementById("criteria").append(li);
        document.getElementById("criteria").append(li2);
        document.getElementById("criteria").append(li3);


        document.getElementById("intro-letter").innerHTML = introLetter_aprov;
        document.getElementById("closing-letter").innerHTML = closingLetter_approv;
      }
    </script>
  </body>
</html>
